# #!/usr/bin/env python
import pandas as pd
import csv
import codecs

# create dict from first csv, with url as key
with open("clean_mep_data.csv", "r") as f:
    first = {rows[0]: rows[1:] for rows in list(csv.reader(f))}

# compare second csv and append rank
with open("mep_prof_img_url.csv", "r") as f:
    for row in csv.reader(f):
        if row[0] in first: # row[0] = url
            first[row[0]].append(row[2]) # row[1] = rank

# convert dict back to list
merged = [(k,) + tuple(v) for k, v in first.items()]

# with open("clean_output.csv", "w", encoding='utf-8') as f:
#     csv.writer(f).writerows(merged)

with open("clean_output.csv", "w") as f:
    csv.writer(f).writerows(merged)


# final_mep_list = ["Ladaktusson", "Isa_Adinolfi", "marcoaffronte", "AgeaLaura", "ClaraAguilera7", "DanielaAiuto", "Tim_Aker", "MarinaAlbiol", "JanAlbrecht", "louis_aliot", "MAlliotMarie", "LucyAndersonMEP", "M_AndersonSF", "MaxAndersson", "EricAndrieuEU", "Andrikiene", "androulakisnick", "gannemans", "Mariearenaps", "MCArnautu", "JonathanArnott", "JeanArthuis", "RichardAshMEP", "Janice4Brexit", "MargreteAuken", "petras_petras", "IAyalaSender", "ayuso_pilar", "BalasGuillaume ", "balcytis", "NBarekov", "AmjadBashirMEP", "GerardBattenMEP", "nicolasbayfn", "HuguesBayet", "catherinemep", "beatrizbecerrab", "beghin_t", "BasBelderMEP", "IvoBelet", "BendtEU", "brandobenifei", "xabierbenito", "PervencheBeres", "Jbergeronmep", "GoffredoBettini", "IzaskunBilbaoB", "DominiqueBilde", "MalinBjork_EU", "pepeblancoEP", "Franc_Bogovic", "simonabonafe", "MichalBoni", "borrellidavid", "BiljanaBorzan", "VictorBostinaru", "josebove", "LNBDublin", "PaulBrannenNE", "mercedesbresso", "renatabriano", "SteeveBriois", "ElmarBrok_MEP", "Dr_KlausBuchner", "MEPDanielBuda", "UdoBullmann", "bueti", "JerzyBuzek", "SoledadCabezon", "AlainCadec", "EnriqueCalvet", "WimvandeCamp", "DCBMEP", "NicolaCaputo", "mattcarthy", "JamesJimCarver", "DavidCasaMEP", "caspary", "FMCastaldo", "delcastillop", "JeanMarieCAVADA", "L_Cesa", "charanzova", "a_chauprade", "NChildersMEP", "CaterinaChinnic", "NikosChountis", "OleEU", "LefChristoforou", "Chrysogonos_K", "SalvoCicu", "AngeloCiocca", "Alberto_Cirio", "DeirdreCluneMEP", "DavidCoburnUKip", "CarlosCoelhoPE", "Cofferati", "Jane_CollinsMEP", "comilara", "ComodiniCachia", "AnnaMariaCB", "RCorbettMEP", "ignaziocorrao", "SilviaCostaEU", "Caninator", "cozzolino62", "MepMCramer", "andicristeamep", "csakypal", "r_czarnecki", "petervdalen", "Miriamdalli", "ddalton40", "JakopDalunde", "rosadamato634", "SebDance", "VioricaDancila", "ArnaudDanjean", "DantiNicola", "MichelDANTIN", "datirachida", "paolodecastro", "Delahaye_Europe", "AndorDeli", "KarimaDelli", "mady_delvaux", "FabioDeMasi", "markdemesmaeker", "IsabellaDeMonte", "jpdenanot", "gerardeprez", "desarnez", "dajcstomi", "NirjDeva", "M_DiaconuMEP", "Mdlabajova", "AnnelieseDodds", "DianeDoddsMEP", "MEPDohrmann", "HerbertDorfmann", "MireilledOrnano", "damiandraghici", "IanDuncanMEP", "PDurandOfficiel", "Stefan_Eck_MEP", "BasEickhout", "LinneaEngstrom", "EpitidGeorgios", "ErnstCornelia", "IsmailErtug", "JillEvansMEP", "EleonoraEvi", "tfajon", "Nigel_Farage", "JoseFariaMEP", "federley", "MarkusFerber", "JMFernandesEU", "jonasfernandez", "e_ferrand", "LFerraraM5S", "SantiagoFisas", "RaffaeleFitto", "Fjellner", "lukeming", "MonikaFlaBenova", "knufleckenstein", "Fontana3Lorenzo", "vickyford", "jfostermep", "FountoulisLampr", "Ashleyfoxmep", "EugenAFreund", "GabrielMariya", "fgambus_eu", "IratxeGarper", "EGardiazabal", "EGardini", "enricogasbarra", "EuropaJens", "elena_gentile", "Gerbrandy", "Arne_Gericke", "lidiageringer", "AdamGierek", "NathanGillMEP", "NeenaGmep", "gimenezbarbat", "juliegirling", "m_giuffrida", "Sylvie_Goddyn", "CharlesGoerens", "brunogollnisch", "AnaGomesMEP", "TaniaGonzalezPs", "gonzalezpons", "BeataGosiewska", "GoulardSylvie", "MJRLdeGraaff", "MariaGrapini", "inge_graessle", "TheresaMEP", "IvetaGrigule", "GrosseteteF", "GrzybAndrzej", "gualtierieurope", "sylvieguillaume", "TonyGuoga", "JytteGuteland", "Sergio_GP", "thadjigeorgiou", "Halla_aho", "thaendel", "DanielJHannan", "MarianHarkin", "RebHarms", "MartinHaeusling", "HeidiHautala", "brianhayesMEP", "anjahazekamp", "AnnaHedh", "RogerHelmerMEP", "HansOlafHenkel", "Hetman_K", "MariaHeubuch", "ghokmark", "maryhoneyball", "MikeHookemMEP", "BriceHortefeux", "danutahuebner", "hudghtonmepSNP", "jhuitema", "SophieintVeld", "carlositurgaiz", "Catalin_Ivan", "Jaakonsaari", "jaatteenmaki", "yjadot", "peter_jahr", "IvanJakovcic", "JFJalkh", "DianeJamesMEP", "RJaureguiA", "javorbenedek", "DJazlowiecka", "JezekCZ", "TeresaJBecerril", "EvaJoly", "DdJong", "a_jongerius", "MarcJoulaud", "Josu_Juaristi", "marekjurek", "philippejuvin", "EvaKaili", "kajakallas", "Kalniete", "SyedKamall", "othmar_karas", "rinakari", "SHKMEP", "krisjaniskarins", "profKarski", "KaufmannSylvia", "M_Kefalogiannis", "KellerHonza", "SkaKeller", "SeanKellyMEP", "Jude_KD", "JeppeKofod", "KohlicekJaromir", "Bernd_Koelmel", "Konecna_K", "korwinmikke", "adamkosamep", "ElliKoestinger", "SteliosKoul", "andreykovatchev", "AKRajewicz", "ZdzKrasnodebski", "ConstanzeKrehl", "BarbaraKudrycka", "WernerKuhnMdEP", "EduardKukan", "miapetrakumpula", "kkuneva", "ZbigniewKuzmiuk", "ckyenge", "KyllonenMerja", "GiorgosKyrtsos", "ilhankyuchyuk", "ALamassoure", "GreenJeanMEP", "ph_lamberts", "Lambsdorff", "berndlange", "Esther_de_Lange", "langen_werner", "LauristinMarju", "giovannilavia", "jlavrilleux", "Gilles_Lebreton", "PatrickLeHyaric", "jo_leinen", "jeroen_lenaers", "lepenjm", "MLP_officiel", "J_Lewandowski", "ALewerMEP", "BLiberadzki", "peterliese", "ArneLietz", "blochbihler", "ph_loiseau", "Loekkegaard_MEP", "SanderLoones", "fjavilopez", "JFLopezAguilar", "palomalopezB", "TonoEPP", "BerndLucke", "olleludvigsson", "UlrikeLunacek", "KrystynaLybacka", "davidmcallister", "LindaMcAvanMEP", "EmmaMcClarkin", "MaireadMcGMEP", "PetrMachMEP", "anthea_mcintyre", "MonicaMacovei1", "VickyMaeijer", "MaleticIvana", "SvMalinov", "curziomaltesetw", "AndrejsMamikins", "RamonaManescu", "fmarcellesi", "Notis_Marias", "MarianMarinescu", "marinhoepinto", "davidmartinmep", "DMartinFN", "edouardmartinEU", "fulviomartuscie", "mmatias_", "GabrielMatoA", "stefanomaullu", "emmanuelmaurel", "alexlmayer", "georgmayermep", "ValentinasMazu1", "gesine_meissner", "JLMelenchon", "JoelleMelinFN", "NunoMeloCDS", "MrMesserschmidt", "MeszericsT", "RobertaMetsola", "LouisMichel", "martina_michels", "miromikolasik", "MatthijsvMilt", "AnneMarieMineur", "MarleneMizzi", "AngelikaMlinar", "GiuliaMoi_M5S", "sorinmoisa", "bernard_monot", "cmonteiroaguiar", "ClareMoodyMEP", "ClaudeMoraesMEP", "nadine__morano", "luigi_morgano", "emorinchartier", "alessiamosca", "UliMuellerMdEP", "SMuresan", "RenaudMuselier", "Ale_Mussolini_", "NagyJozsefEU", "negrescuvictor", "momchilnekov", "JNicholsonMEP", "ANiebler", "LudekNie", "NiedermullerMEP", "CvNieuwenhuizen", "jensni", "LiadhNiRiadaMEP", "LvNistelrooij", "AndreyNovakov", "paulnuttallukip", "franzobermayr", "oflynnmep", "JanOlbrycht", "younousomarjee", "biuroposelskie", "Pabriks", "Urmaspaet", "maitepagaza", "RolandasPaksas", "AntonioPanzeri", "MassimoPaolucc6", "DemPapadakis", "papadimoulis", "gillespargneaux", "MargotLJParker", "PatricielloAldo", "PavelEmilian", "PediciniM5S", "Vincent_Peillon", "lojzepeterle", "mortenhelveg", "marijana_petir", "f_philippot", "pinapic", "TPicula", "markuspieperMEP", "spietikainen", "KatiPiri", "giannipittella", "pavelpoc", "PocheMEP", "SalvoPogliese", "stanislavpolcak", "mauriceponga", "TomaszPoreba", "Pospisil_Jiri", "SorayaPostFi", "CDPreda", "MarcusPretzell", "GabrielePreuss", "JProcterMEP", "franckproust", "CarolinaPunset", "GQuisthoudt", "Emil_Radev", "jozorados", "libertarofuturo", "Senficon", "VivianeRedingEU", "Evelyn_Regner", "julia_reid", "michelreimon", "TerryReintke", "hreul", "cdallonnes", "SofiaHRibeiro", "Frederiqueries", "DominiqueRiquet", "MicheleRivasi", "robertrochefort", "LilianaMEP", "MJRodriguesEU", "RodriguezPinero", "UlrikeRodust", "rohde_jens", "clauderolin", "BronisRopeLT", "DariuszRosati", "VRoziere", "fernandoruas", "PaulRuebig", "TokiaSaifi", "SofiaSakorafa", "MaxSalini", "matteosalvinimi", "LolaPodemos", "ASanderMEP", "SantAlfred", "DacianaSarbu", "judithineuropa", "petrisarvamaa", "JSaryuszWolski", "DavidSassoli", "SaudargasA", "MarietjeSchaake", "JLSchaffhauser", "SchaldemoseMEP", "ellyesse", "Schmidt_Clau", "HelmutScholzMEP", "schopflinMEP", "AnnieSchreijer", "MartinSchulz", "schulzeeuropa", "Andreas_Schwab", "OlgaSehnalova", "jasenkos", "LidiaSenra", "SernagiottoRemo", "JSeymourUKIP", "CzSiekierski", "PeterSimonMEP", "sionsimon", "BirgitSippelMEP", "BranoSkripek", "DavorSkrlec", "AlynSmithMEP", "SmolkovaMonika", "msojdrova", "jordisolef", "isoltesEP", "MartinSonneborn", "renatosoru", "MariaSpyraki", "BartStaes", "SergeiStanishev", "JStarbatty", "IvanStefanec", "JuttaSteinruck", "StetinaEP", "StevensHelga", "C_Stihler_MEP", "TheodorStolojan", "Beatrix_vStorch", "OlafStuger", "dubravkasuica", "SulikRichard", "PatricijaSulin", "1PavelSvoboda", "KaySwinburneMEP", "sylikiotis", "Synadinos_Eleft", "szanyitibor", "szejnfeld", "Antonio_Tajani", "HTakkula", "tamburrano", "paultang", "CharlesTannock", "ClaudiaTapardel", "marctarabella", "indrektarand", "GreenKeithMEP", "Telicka", "jmterricabras", "THEOCHAROUSE", "EUTheurer", "Isabel_thomasEU", "rozathun", "toiapatrizia", "RuzaTomasic", "RomanaTomc", "YanaToom", "etorrespodemos", "NilsTorvalds", "EvzenTosenovsky", "TrebesiusMdEP", "ramontremosa", "Troszczynski_FN", "HelgaTruepel", "turcanu2014", "ClaudeTurmes", "kmujazdowski", "istvan_ujhelyi", "maritaulvskog", "TraianUngureanu", "MiguelUrban", "ernesturtasun", "ViktorUspaskich", "IneseVaidere", "ivajgl", "ElenaValenciano", "bodilvalero", "MarcoValliM5S", "AngelaVallina", "MonikaVana", "anneleen_vb", "kvanbrempt", "tomvdkendelaere", "derekvaughan", "hildevautmans", "kokokansanpaavo", "MCVergiat", "sabineverheyen", "GuyVerhofstadt", "vilimsky", "danieleviotti", "HennaVirkkunen", "AndersVistisen", "udovoigt", "AxelVossMdEP", "vozemberg", "WalesaMEP", "julie4nw", "ManfredWeber", "renateweber", "Weidenholzer", "MartinaWernerEU", "WestphalKerstin", "LieveWierinck", "CeciliaWikstrom", "GlenisWillmott", "KristinaWinberg", "IuliuWinkler", "j_wisniewska", "Steven_Woolfe", "woelken", "ZahradilJan", "zalaboris", "Marcozanni86", "flaviozanonato", "Tatjana_Zdanoka", "TomZdechovsky", "BZdrojewski", "joachimzeller", "JanuszZemke", "robertszile", "GabiZimmerMEP", "DamianoZoffoli", "czorrinho", "ZeljanaZovko", "MarcoZullo", "MilanZver", "TadeuszZwiefka"]

# mep_df = pd.read_csv('meps_full_list_with_twitter_accounts.csv')
# messy_mep_list = mep_df['SCREEN_NAME'].tolist()
# mask = mep_df['SCREEN_NAME'].isin(final_mep_list)
# mep_df_clean = mep_df[mask]


# mep_df_clean.to_csv("clean_mep_data.csv", sep=',', encoding='utf-8')